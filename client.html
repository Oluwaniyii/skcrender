<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
</head>
<body>
    <h2>Bi dricectional chat</h2>

    <ul id="messages"></ul>

    <div>
        <input type="text" />
        <button onclick="sendMessage()">send</button>
    </div>
</body>
<script>
    const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3N1ZWRfYXQiOjE3MDUzMTE4MzE4NTAsImV4cGlyZV9pbiI6ODY0MDAwMDAsImRhdGEiOnsidXNlcl9pZCI6IjFjNzNmYjA4LWU4OTgtNDkxOC05MzJiLWQyYzFjZjBmODkxOSIsImlkIjoiMWM3M2ZiMDgtZTg5OC00OTE4LTkzMmItZDJjMWNmMGY4OTE5IiwibmFtZSI6IkFwb2xsbyBDcmVlZCIsInRhZyI6ImNyZWVkMDEiLCJ3YWxsZXRfaWQiOiIzNzhmMjIwZC0xODFlLTQ5YTItODQzZS00OGE0YTdhNGM0ODQifSwiaWF0IjoxNzA1MzExODMxfQ.CNPDLdC8DWmRPTDQ9ujl5Jf17sEqMKKl5Qfcd_igz6w"
    const ws = new WebSocket("ws://localhost:8383?token=");

    ws.onopen = function (e) {
        console.log("Connection to server opened");
    };

    ws.onmessage = function (e) {
        var data = JSON.parse(e.data);
        console.log(data);

        var enc = new TextDecoder("utf-8");
        var m = (new TextEncoder()).encode("hi");
        console.log(m)


        var messages = document.getElementById("messages");
        var message = document.createElement("li");
        message.innerHTML = Buffer.from(data.message).toString()
        messages.appendChild(message);
    };

    function sendMessage() {
        const message = document.querySelector("input").value;
        ws.send(message);

    }

    (function focus() {
        const textInput = document.querySelector("input");
        textInput.focus();
    })();
</script>
</html>